<!-- navigation -->
<header class="navigation">
  <div class="container">
    <a href="#contact-info" class="skip-to-content" role="link">
      {{ i18n "skip_to_contact" }}
    </a>

    <!-- navbar -->
    <nav class="navbar navbar-expand-lg navbar-light justify-content-between">
      <!-- navbar brand/logo -->
      <a class="navbar-brand" href="{{ site.BaseURL | relLangURL }}">
        <span class="no-image-fallback">
          <h1>AccessLiaison</h1>
        </span>
        {{ partial "logo.html" . }}
      </a>

      <div class="d-flex align-items-center">
        {{ if site.Params.navigation_button.enable }}
        <!-- Appearance Settings -->
        <div class="dropdown js--appearance-settings">
          <button
          class="btn btn-outlined ms-lg-4 mt-2 mt-lg-0 dropdown-toggle appearance-btn"
          data-bs-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false"
          data-bs-auto-close="outside">
            <svg class="appearance-icon d-none d-md-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38">
              <g><path d="M29.1,12.2h-9.7c-.6-1.9-2.3-3.4-4.5-3.4s-3.9,1.4-4.5,3.4h-1.7c-.7,0-1.3.6-1.3,1.3s.6,1.3,1.3,1.3h1.7c.6,1.9,2.3,3.4,4.5,3.4s3.9-1.4,4.5-3.4h9.7c.7,0,1.3-.6,1.3-1.3s-.6-1.3-1.3-1.3ZM15,15.6c-1.2,0-2.1-.9-2.1-2.1s.9-2.1,2.1-2.1,2.1.9,2.1,2.1-.9,2.1-2.1,2.1Z" />
                <path d="M29.1,23.2h-1.7c-.6-1.9-2.3-3.4-4.5-3.4s-3.9,1.4-4.5,3.4h-9.7c-.7,0-1.3.6-1.3,1.3s.6,1.3,1.3,1.3h9.7c.6,1.9,2.3,3.4,4.5,3.4s3.9-1.4,4.5-3.4h1.7c.7,0,1.3-.6,1.3-1.3,0-.7-.6-1.3-1.3-1.3ZM23,26.6c-1.2,0-2.1-.9-2.1-2.1s.9-2.1,2.1-2.1,2.1.9,2.1,2.1c0,1.2-.9,2.1-2.1,2.1Z" />
              </g>
              <path d="M19,38c-5.1,0-9.8-2-13.4-5.6C2,28.8,0,24.1,0,19S2,9.2,5.6,5.6,13.9,0,19,0s9.8,2,13.4,5.6c3.6,3.6,5.6,8.4,5.6,13.4s-2,9.8-5.6,13.4c-3.6,3.6-8.4,5.6-13.4,5.6ZM19,2.5c-4.4,0-8.5,1.7-11.6,4.8s-4.8,7.2-4.8,11.6,1.7,8.5,4.8,11.6c3.1,3.1,7.2,4.8,11.6,4.8s8.5-1.7,11.6-4.8c3.1-3.1,4.8-7.2,4.8-11.6s-1.7-8.5-4.8-11.6c-3.1-3.1-7.2-4.8-11.6-4.8Z" />
            </svg>

            <span class="appearance-btn-label">
              {{ i18n "appearance_dropdown" }}
            </span>
            <svg class="dropdown-icon" width="16" height="10" viewBox="0 0 14 8" xmlns="http://www.w3.org/2000/svg">
              <path class="arrow-path" d="M13.73,1.69l-6.02,6.02c-.39.39-1.03.39-1.42,0L.27,1.69C-.11,1.28-.09.65.32.27.7-.09,1.3-.09,1.69.27l5.31,5.31L12.31.27c.41-.38,1.04-.36,1.42.05.36.39.36.98,0,1.37Z"/>
            </svg>

            <svg class="appearance-icon d-md-none appearance-icon-default" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38">
              <g>
                <path d="M29.1,12.2h-9.7c-.6-1.9-2.3-3.4-4.5-3.4s-3.9,1.4-4.5,3.4h-1.7c-.7,0-1.3.6-1.3,1.3s.6,1.3,1.3,1.3h1.7c.6,1.9,2.3,3.4,4.5,3.4s3.9-1.4,4.5-3.4h9.7c.7,0,1.3-.6,1.3-1.3s-.6-1.3-1.3-1.3ZM15,15.6c-1.2,0-2.1-.9-2.1-2.1s.9-2.1,2.1-2.1,2.1.9,2.1,2.1-.9,2.1-2.1,2.1Z"/>
                <path d="M29.1,23.2h-1.7c-.6-1.9-2.3-3.4-4.5-3.4s-3.9,1.4-4.5,3.4h-9.7c-.7,0-1.3.6-1.3,1.3s.6,1.3,1.3,1.3h9.7c.6,1.9,2.3,3.4,4.5,3.4s3.9-1.4,4.5-3.4h1.7c.7,0,1.3-.6,1.3-1.3s-.6-1.3-1.3-1.3ZM23,26.6c-1.2,0-2.1-.9-2.1-2.1s.9-2.1,2.1-2.1,2.1.9,2.1,2.1-.9,2.1-2.1,2.1Z"/>
              </g>
              <path d="M19,38c-5.1,0-9.8-2-13.4-5.6C2,28.8,0,24.1,0,19S2,9.2,5.6,5.6,13.9,0,19,0s9.8,2,13.4,5.6c3.6,3.6,5.6,8.4,5.6,13.4s-2,9.8-5.6,13.4c-3.6,3.6-8.4,5.6-13.4,5.6ZM19,2.5c-4.4,0-8.5,1.7-11.6,4.8s-4.8,7.2-4.8,11.6,1.7,8.5,4.8,11.6,7.2,4.8,11.6,4.8,8.5-1.7,11.6-4.8c3.1-3.1,4.8-7.2,4.8-11.6s-1.7-8.5-4.8-11.6c-3.1-3.1-7.2-4.8-11.6-4.8Z"/>
            </svg>

            <svg class="appearance-icon d-md-none appearance-icon-hover" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38">
              <path d="M23,22.4c-1.2,0-2.1.9-2.1,2.1s.9,2.1,2.1,2.1,2.1-.9,2.1-2.1-.9-2.1-2.1-2.1Z"/>
              <path d="M15,11.4c-1.2,0-2.1.9-2.1,2.1s.9,2.1,2.1,2.1,2.1-.9,2.1-2.1-.9-2.1-2.1-2.1Z"/>
              <path d="M32.4,5.6C28.8,2,24.1,0,19,0S9.2,2,5.6,5.6C2,9.2,0,13.9,0,19s2,9.8,5.6,13.4c3.6,3.6,8.3,5.6,13.4,5.6s9.8-2,13.4-5.6c3.6-3.6,5.6-8.4,5.6-13.4s-2-9.8-5.6-13.4ZM29.1,25.8h-1.7c-.6,2-2.3,3.4-4.5,3.4s-3.9-1.5-4.5-3.4h-9.7c-.7,0-1.3-.6-1.3-1.3s.6-1.3,1.3-1.3h9.7c.6-2,2.3-3.4,4.5-3.4s3.9,1.5,4.5,3.4h1.7c.7,0,1.3.6,1.3,1.3s-.6,1.3-1.3,1.3ZM29.1,14.8h-9.7c-.6,2-2.3,3.4-4.5,3.4s-3.9-1.5-4.5-3.4h-1.7c-.7,0-1.3-.6-1.3-1.3s.6-1.3,1.3-1.3h1.7c.6-2,2.3-3.4,4.5-3.4s3.9,1.5,4.5,3.4h9.7c.7,0,1.3.6,1.3,1.3s-.6,1.3-1.3,1.3Z"/>
            </svg>

          </button>
          <ul class="dropdown-menu dropdown-menu-md-start p-0">
            <li class="p-0">
              <fieldset class="dropdown-theme dropdown-section">
                <legend class="dropdown-heading pt-4 fw-bold">
                  {{ i18n "theme_header" }}
                </legend>


                <li class="dropdown-item js--dropdown-item">
                  <div class="form-check radio-field">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="theme-picker"
                      id="theme-dark"
                      value="dark"
                      />
                    <label class="form-check-label" for="theme-dark">
                      {{ i18n "theme_dark" }}
                    </label>
                  </div>
                </li>

                <li class="dropdown-item js--dropdown-item">
                  <div class="form-check radio-field">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="theme-picker"
                      id="theme-light"
                      value="light"
                      />
                    <label class="form-check-label" for="theme-light">
                      {{ i18n "theme_light" }}
                    </label>
                  </div>
                </li>
                <li class="dropdown-item js--dropdown-item">
                  <div class="form-check radio-field">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="theme-picker"
                      id="theme-auto"
                      checked="checked"
                      value="auto"
                    />
                    <label class="form-check-label" for="theme-auto">
                      {{ i18n "theme_auto" }}
                    </label>
                  </div>
                </li>
              </fieldset>
            </li>

            <li class="dropdown-item js--dropdown-item">
              <div class="switch-field">
                {{ partial "switch" (dict "id" "switch-large-text") }}
                <label for="switch-large-text">
                  {{ i18n "switch_large_text"}}
                </label>
              </div>
            </li>

            <li class="dropdown-item js--dropdown-item">
              <div class="switch-field">
                {{ partial "switch" (dict "id" "switch-remove-images") }}
                <label for="switch-remove-images">
                  {{ i18n "switch_remove_images"}}
                </label>
              </div>
            </li>

            <li class="dropdown-item js--dropdown-item">
              <div class="switch-field">
                {{ partial "switch" (dict "id" "switch-reduce-animation") }}
                <label for="switch-reduce-animation">
                  {{ i18n "switch_reduce_animation"}}
                </label>
              </div>
            </li>

            <li class="dropdown-item dropdown-item-reset js--dropdown-item">
              <button class="reset-button" >
                <svg xmlns="http://www.w3.org/2000/svg"
                  height="24px"
                  width="24px"
                  role="presentation"
                  aria-hidden="true" viewBox="0 -960 960 960"><path d="M480-160q-134 0-227-93t-93-227q0-134 93-227t227-93q69 0 132 28.5T720-690v-110h80v280H520v-80h168q-32-56-87.5-88T480-720q-100 0-170 70t-70 170q0 100 70 170t170 70q77 0 139-44t87-116h84q-28 106-114 173t-196 67Z"/></svg>
                <span> {{i18n "reset_defaults" }} </span>
              </button>
            </li>

          </ul>
        </div>

        {{ end }}
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<!-- theme switcher -->
{{ if site.Params.theme_switcher }}
<script>

  document.addEventListener("DOMContentLoaded", () => {


    const appearanceMenu = document.querySelector(".js--appearance-settings");
    const themeOptions = appearanceMenu.querySelectorAll(
      'input[name="theme-picker"]'
    );
    const largeTextSwitch = appearanceMenu.querySelector("#switch-large-text");
    const removeImagesSwitch = appearanceMenu.querySelector("#switch-remove-images");
    const reduceAnimationsSwitch = appearanceMenu.querySelector("#switch-reduce-animation");
    const resetButton = appearanceMenu.querySelector(".reset-button");

    const LARGE_TEXT_KEY = "large-text-enabled";
    const REMOVE_IMAGES_KEY = "remove-images-enabled";
    const REDUCE_ANIMATIONS_KEY = "reduce-animation-enabled";
    const PREFERRED_THEME_KEY = "preferred-theme";


    /**
     * Click Handler
     */
    appearanceMenu.addEventListener("click", (event) => {
      const target = event.target;

      if (largeTextSwitch.contains(target)) {
        event.preventDefault();
        handleLargeText(target.checked);
        saveAppearancePreferences(LARGE_TEXT_KEY, target.checked);
      }

      if (removeImagesSwitch.contains(target)) {
        handleRemoveImages(target.checked);
        saveAppearancePreferences(REMOVE_IMAGES_KEY, target.checked);
      }

      if (reduceAnimationsSwitch.contains(target)) {
        handleReduceAnimations(target.checked);
        saveAppearancePreferences(REDUCE_ANIMATIONS_KEY, target.checked);
      }

      if (target.closest('[name="theme-picker"]')) {
        event.preventDefault();
        handleThemeChange(target.value);
        saveAppearancePreferences(PREFERRED_THEME_KEY, target.value);
      }

      if (resetButton.contains(target)) {
        event.preventDefault();
        [
          LARGE_TEXT_KEY,
          REMOVE_IMAGES_KEY,
          REDUCE_ANIMATIONS_KEY,
          PREFERRED_THEME_KEY
        ].forEach((key) => {
          removeAppearancePreferences(key);
        });
        location.reload();
      }
    });

    /**
     * Remove Images Handler
     */
    const handleRemoveImages = (isImagesRemoved) => {
      isImagesRemoved = isImagesRemoved || false;

      setTimeout(() => {
        removeImagesSwitch.checked = isImagesRemoved;
        isImagesRemoved
          ? removeImagesSwitch.setAttribute("checked", true)
          : removeImagesSwitch.removeAttribute("checked");
      });

      if (isImagesRemoved) {
        document.body.classList.remove("remove-images");
        document.body.classList.add("remove-images");
      } else {
        document.body.classList.remove("remove-images");
      }
    };

    /**
     * Reduce Animations Handler
     */
    const handleReduceAnimations = (isAnimationsReduced) => {
      isAnimationsReduced = isAnimationsReduced || false;

      setTimeout(() => {
        reduceAnimationsSwitch.checked = isAnimationsReduced;
        isAnimationsReduced
          ? reduceAnimationsSwitch.setAttribute("checked", true)
          : reduceAnimationsSwitch.removeAttribute("checked");
      });

      if (isAnimationsReduced) {
        document.body.classList.remove("reduce-animations");
        document.body.classList.add("reduce-animations");
      } else {
        document.body.classList.remove("reduce-animations");
      }
    };


    /**
     * Large Text Handler
     */
    const handleLargeText = (isTextLarge) => {
      isTextLarge = isTextLarge || false;

      setTimeout(() => {
        largeTextSwitch.checked = isTextLarge;
        isTextLarge
          ? largeTextSwitch.setAttribute("checked", true)
          : largeTextSwitch.removeAttribute("checked");
      });

      if (isTextLarge) {
        document.body.classList.remove("text-large");
        document.body.classList.add("text-large");
        document.documentElement.style.fontSize = '16px';
      } else {
        document.body.classList.remove("text-large");
        document.documentElement.style.fontSize = '';
      }
    };

    /**
     * Theme Handler :: START
     */
    const setLightTheme = () => {
      document.body.classList.remove("dark");
    };

    const setDarkTheme = () => {
      if (!document.body.classList.contains("dark")) {
        document.body.classList.add("dark");
      }
    };

    const setAutoTheme = () => {
      if (!window.matchMedia) {
        setDarkTheme();
      }

      if (appearanceMenu.querySelector('input[value="auto"]').checked) {
        window.matchMedia("(prefers-color-scheme: dark)").matches
          ? setDarkTheme()
          : setLightTheme();
      }
    };

    const handleThemeChange = (themePreferences) => {
      // sets 'auto' theme by default
      themePreferences = themePreferences ? themePreferences : "auto";

      const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
      if (themePreferences !== "auto") {
        mediaQuery.removeEventListener("change", setAutoTheme);
      }

      switch (themePreferences) {
        case "light":
          setLightTheme();
          break;
        case "dark":
          setDarkTheme();
          break;
        default:
          setAutoTheme();
          mediaQuery.addEventListener("change", setAutoTheme);
      }

      // Marks radio buttons as checked programmatically
      setTimeout(() => {
        // hack needed for boostrap to complete update cycle
        themeOptions.forEach((option) => {
          themePreferences === option.value
            ? option.setAttribute("checked", "checked")
            : option.removeAttribute("checked");
          option.checked = themePreferences === option.value;
        });
      });
    };
    /** Theme Handler :: END */

    /**
     * Store user preferences
     */
    const saveAppearancePreferences = (name, value) => {
      localStorage.setItem(name, value);
    };

    const removeAppearancePreferences = (name) => {
      localStorage.removeItem(name);
    };

    const getStoredAppearancePreferences = () => {
      const themePreferences = localStorage.getItem(PREFERRED_THEME_KEY);
      handleThemeChange(themePreferences);

      const largeTextPreferences = localStorage.getItem(LARGE_TEXT_KEY);
      handleLargeText(JSON.parse(largeTextPreferences));

      const removeImagesPreferences = localStorage.getItem(REMOVE_IMAGES_KEY);
      handleRemoveImages(JSON.parse(removeImagesPreferences));

      const reduceAnimationsPreferences = localStorage.getItem(REDUCE_ANIMATIONS_KEY);
      handleReduceAnimations(JSON.parse(reduceAnimationsPreferences));
    };

    getStoredAppearancePreferences();
  });
</script>
{{ end }}
